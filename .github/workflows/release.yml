name: Create GitHub Release

on:
  push:
    tags:
      - 'v*'
  workflow_dispatch:

permissions:
  contents: write
  issues: write
  pull-requests: write

jobs:
  release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      issues: write
      pull-requests: write
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
      
    - name: Create Release Notes
      run: |
        cat > release_notes.md << 'EOF'
        ## ðŸš€ CastPlan MCP ${{ github.ref_name }}
        
        Universal AI coding assistant with project memory and awareness.
        
        ### ðŸ“¦ Quick Install (Direct from GitHub)
        
        **ðŸ”¥ Instant setup (uvx - No installation needed):**
        ```bash
        uvx --from git+https://github.com/Ghostseller/CastPlan_mcp.git castplan-mcp init
        ```
        
        **ðŸš€ Install with uv:**
        ```bash
        uv add git+https://github.com/Ghostseller/CastPlan_mcp.git
        castplan-mcp init
        ```
        
        **ðŸ“¦ Install with pip:**
        ```bash
        pip install git+https://github.com/Ghostseller/CastPlan_mcp.git
        castplan-mcp init
        ```
        
        **ðŸ“¦ Install with npm:**
        ```bash  
        npm install -g git+https://github.com/Ghostseller/CastPlan_mcp.git
        castplan-mcp init
        ```
        
        **ðŸ› ï¸ Alternative Installation Methods:**
        ```bash
        # Clone and use alternative installer
        git clone https://github.com/Ghostseller/CastPlan_mcp.git
        cd CastPlan_mcp
        node scripts/install-alternatives.js smart
        ```
        
        ### âœ¨ What This Does
        - **Gives your AI memory** - Remembers your project structure, patterns, and decisions
        - **Auto-configures** - Works with Claude, Cursor, VS Code, and all MCP clients
        - **Zero setup** - Detects and configures everything automatically
        - **Universal** - Cross-platform support (Windows, macOS, Linux)
        
        ### ðŸŽ¯ Key Features
        - **Project-aware AI assistance** - AI understands your specific codebase
        - **Documentation automation** - Keeps docs in sync with code
        - **Smart task management** - AI-powered project planning (BMAD)
        - **Workflow intelligence** - Learns and automates your development patterns
        
        ### ðŸš€ What's New in ${{ github.ref_name }}
        - **ì„¤ì¹˜ ë¬¸ì œ ì™„ì „ í•´ê²°** - deprecated íŒ¨í‚¤ì§€ ê²½ê³  ì œê±°
        - **ë‹¤ì¤‘ ì„¤ì¹˜ ë°©ë²• ì§€ì›** - npx, git-clone, dev, docker, smart ë°©ì‹ ì œê³µ
        - **Python bridge ì•ˆì •ì„± í–¥ìƒ** - íŒ¨í‚¤ì§€ëª… ìˆ˜ì • ë° í˜¸í™˜ì„± ê°œì„ 
        - **ì¢…í•© ì„¤ì¹˜ ê°€ì´ë“œ** - INSTALL.mdë¡œ ìƒì„¸í•œ ì„¤ì¹˜ ë°©ë²• ë¬¸ì„œí™”
        - **í¬ë¡œìŠ¤ í”Œëž«í¼ í˜¸í™˜ì„±** - Windows, macOS, Linux ëª¨ë‘ ì•ˆì •ì ìœ¼ë¡œ ì§€ì›
        
        ### ðŸ”— Links
        - [GitHub Repository](https://github.com/Ghostseller/CastPlan_mcp)
        - [Installation Guide](https://github.com/Ghostseller/CastPlan_mcp/blob/main/INSTALL.md)
        - [Issues & Support](https://github.com/Ghostseller/CastPlan_mcp/issues)
        - [Contact](mailto:banessayuu@gmail.com)
        
        ### ðŸ’¡ Why CastPlan MCP?
        
        Stop explaining your project to AI every time. CastPlan MCP gives your AI assistant **persistent memory** of your codebase, so it can provide context-aware help from day one.
        
        **Before:** *"What's your tech stack? Where are your components? What's your architecture?"*
        
        **After:** *"Based on your existing UserCard pattern, here's a ProfileCard that matches your design system..."*
        EOF
        
    - name: Create GitHub Release
      run: |
        gh release create ${{ github.ref_name }} \
          --title "CastPlan MCP ${{ github.ref_name }}" \
          --notes-file release_notes.md \
          --latest
      env:
        GH_TOKEN: ${{ github.token }}